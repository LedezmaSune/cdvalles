<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enviar a WhatsApp (Click to Chat)</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --muted:#9aa4b2;
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, Arial, sans-serif}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg,#071029 0%, #0b1220 100%); color:#e6eef6; padding:24px;
    }
    .card{width:100%; max-width:760px; background:var(--card); border-radius:14px; padding:28px; box-shadow:0 8px 30px rgba(2,6,23,0.6);}
    h1{margin:0 0 6px; font-size:20px;}
    p.lead{margin:0 0 18px; color:var(--muted);}
    label{display:block; font-size:13px; margin-top:12px; color:#cfeaf4;}
    input[type="text"], textarea{
      width:100%; padding:10px 12px; margin-top:6px; border-radius:8px; border:1px solid rgba(255,255,255,0.04);
      background:rgba(255,255,255,0.02); color:inherit; font-size:14px;
    }
    .row{display:flex; gap:12px;}
    .row .col{flex:1;}
    button{
      margin-top:14px; background:var(--accent); color:#052027; border:none; padding:10px 14px; border-radius:10px;
      font-weight:600; cursor:pointer;
    }
    .small{font-size:12px; color:var(--muted); margin-top:8px;}
    .link-preview{margin-top:12px; padding:10px; border-radius:8px; background:rgba(255,255,255,0.02); font-size:13px; word-break:break-all}
    footer{margin-top:18px; font-size:12px; color:var(--muted)}
  </style>
</head>
<body>
  <div class="card">
    <h1>Enviar mensaje por WhatsApp (Click-to-Chat)</h1>
    <p class="lead">Introduce el número en formato internacional (sin +, sin ceros delante) y tu mensaje. Se abrirá WhatsApp con el texto prellenado.</p>

    <label for="phone">Número (ej. 5215512345678 para México)</label>
    <input id="phone" type="text" placeholder="Código país + número (sin signos)" autocomplete="tel" />

    <label for="message">Mensaje</label>
    <textarea id="message" rows="4" placeholder="Escribe tu mensaje personalizado aquí..."></textarea>

    <div class="row">
      <div class="col">
        <button id="openBtn">Abrir en WhatsApp</button>
      </div>
      <div class="col" style="min-width:160px">
        <button id="copyBtn" type="button">Copiar enlace</button>
      </div>
    </div>

    <div class="small">Vista previa del enlace:</div>
    <div id="preview" class="link-preview">Aquí aparecerá el enlace generado...</div>

    <footer>
      <div>Formato requerido: solo dígitos, con código de país. Ejemplo: <code>5215512345678</code>.</div>
      <div>[No verificado] Si quieres ocultar el número en el enlace público, considera acortar con un servicio como Bitly (esto es una sugerencia; verifica políticas y privacidad del acortador antes de usarlo).</div>
    </footer>
  </div>

  <script>
    const phoneEl = document.getElementById('phone');
    const msgEl = document.getElementById('message');
    const previewEl = document.getElementById('preview');
    const openBtn = document.getElementById('openBtn');
    const copyBtn = document.getElementById('copyBtn');

    function sanitizeNumber(n){
      return (n||'').replace(/[^0-9]/g, '');
    }

    function buildLink(){
      const phone = sanitizeNumber(phoneEl.value.trim());
      const text = (msgEl.value || '').trim();
      const encoded = encodeURIComponent(text);
      // Si el usuario no escribe número, abrimos el selector de contactos con solo el texto
      if(!phone) return `https://wa.me/?text=${encoded}`;
      return `https://wa.me/${phone}?text=${encoded}`;
    }

    function updatePreview(){
      const link = buildLink();
      previewEl.textContent = link;
    }

    phoneEl.addEventListener('input', updatePreview);
    msgEl.addEventListener('input', updatePreview);
    updatePreview();

    openBtn.addEventListener('click', () => {
      const phone = sanitizeNumber(phoneEl.value.trim());
      if(phone && phone.length < 6){
        alert('Número demasiado corto. Asegúrate de incluir código de país.');
        return;
      }
      const url = buildLink();
      // Abrir en nueva pestaña - si el dispositivo tiene WhatsApp instalado se abrirá la app
      window.open(url, '_blank');
    });

    copyBtn.addEventListener('click', () => {
      const url = buildLink();
      navigator.clipboard?.writeText(url).then(()=> {
        alert('Enlace copiado al portapapeles');
      }).catch(()=> {
        prompt('Copia manualmente:', url);
      });
    });
  </script>
</body>
</html>
